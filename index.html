<?php
session_start();

// Daftar bahan
$bahanList = [
    "Kunyit" => ["harga" => 1500, "jenis" => "Bahan utama"],
    "Jahe" => ["harga" => 1200, "jenis" => "Bahan utama"],
    "Gula Merah" => ["harga" => 1000, "jenis" => "Pemanis"]
];

// Inisialisasi keranjang
if (!isset($_SESSION['keranjang'])) {
    $_SESSION['keranjang'] = [];
}

// Tambah bahan ke keranjang
if (isset($_POST['tambah'])) {
    $nama = $_POST['nama'];
    $jumlah = intval($_POST['jumlah'] ?? 1);
    if (isset($bahanList[$nama])) {
        $_SESSION['keranjang'][$nama] = $jumlah;
    }
}

// Hapus satu item dari keranjang
if (isset($_POST['hapus'])) {
    $nama = $_POST['hapus'];
    unset($_SESSION['keranjang'][$nama]);
}

// Reset seluruh keranjang
if (isset($_POST['reset'])) {
    $_SESSION['keranjang'] = [];
}
?>

<!DOCTYPE html>
<html>
<head>
    <title>Aplikasi Jamu</title>
    <style>
        table {
            border-collapse: collapse;
            width: 70%;
        }
        th, td {
            border: 1px solid #aaa;
            padding: 8px;
            text-align: center;
        }
        h2 {
            color: orange;
        }
        button {
            background-color: orange;
            border: none;
            padding: 5px 10px;
            color: white;
            cursor: pointer;
        }
    </style>
</head>
<body>

<h2>Daftar Bahan</h2>
<table>
    <tr>
        <th>Nama</th>
        <th>Jenis</th>
        <th>Harga</th>
        <th>Jumlah</th>
        <th>Aksi</th>
    </tr>
    <?php foreach ($bahanList as $nama => $info): ?>
    <tr>
        <form method="post">
            <td><?= $nama ?></td>
            <td><?= $info['jenis'] ?></td>
            <td><?= $info['harga'] ?></td>
            <td><input type="number" name="jumlah" value="1" min="1"></td>
            <td>
                <input type="hidden" name="nama" value="<?= $nama ?>">
                <button type="submit" name="tambah">Tambah</button>
            </td>
        </form>
    </tr>
    <?php endforeach; ?>
</table>

<h2>Keranjang Belanja</h2>
<table>
    <tr>
        <th>Nama</th>
        <th>Jumlah</th>
        <th>Subtotal</th>
        <th>Aksi</th>
    </tr>
    <?php
    $total = 0;
    foreach ($_SESSION['keranjang'] as $nama => $jumlah):
        $harga = $bahanList[$nama]['harga'];
        $subtotal = $harga * $jumlah;
        $total += $subtotal;
    ?>
    <tr>
        <form method="post">
            <td><?= $nama ?></td>
            <td><?= $jumlah ?></td>
            <td><?= $subtotal ?></td>
            <td>
                <button type="submit" name="hapus" value="<?= $nama ?>">Hapus</button>
            </td>
        </form>
    </tr>
    <?php endforeach; ?>
    <tr>
        <td colspan="2"><strong>Total</strong></td>
        <td colspan="2"><strong><?= $total ?></strong></td>
    </tr>
</table>

<form method="post">
    <button type="submit" name="reset">Reset Keranjang</button>
</form>

</body>
</html>

